<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <title>Slot Oyunu</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: url('https://i.imgur.com/gfM9dLw.jpeg') center/cover no-repeat;
      color: #fff;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    h1 {
      font-size: 6vw;
      margin-top: 4vw;
      color: #ffcc00;
      text-shadow: 1px 1px 2px #000;
    }

    .slot-wrapper {
      padding: 3vw;
      max-width: 100vw;
      box-sizing: border-box;
    }

    .slot-container {
      display: grid;
      grid-template-columns: repeat(5, 18vw);
      grid-template-rows: repeat(3, 18vw);
      gap: 1.5vw;
      justify-content: center;
      background: radial-gradient(circle at center, #111 0%, #000 100%);
      border: 0.7vw solid #4CAF50;
      padding: 3vw;
      border-radius: 3vw;
      box-shadow: 0 0 2vw #0f0;
      margin-bottom: 4vw;
    }

    .slot-cell {
      width: 18vw;
      height: 18vw;
      background-color: #1a1a1a;
      border-radius: 3vw;
      border: 0.4vw solid #4CAF50;
      overflow: hidden;
      position: relative;
      box-shadow: inset 0 0 1vw #0f0;
    }

    .symbol {
      position: absolute;
      width: 100%;
      height: 100%;
      font-size: 6vw;
      display: flex;
      align-items: center;
      justify-content: center;
      top: -100%;
      transition: top 0.2s ease-in-out;
    }

    .symbol.show {
      top: 0;
    }

    .symbol.win {
      animation: winFlash 1.5s infinite;
    }

    @keyframes winFlash {
      0% { background-color: transparent; }
      50% { background-color: gold; color: black; }
      100% { background-color: transparent; }
    }

    .bet-bar-wrapper {
      overflow-x: auto;
      white-space: nowrap;
      padding: 2vw;
      margin: 4vw 0;
    }

    .bet-bar {
      display: inline-flex;
      gap: 2vw;
    }

    .bet-button {
      flex: 0 0 auto;
      padding: 2vw 4vw;
      font-size: 4vw;
      background: linear-gradient(145deg, #222, #111);
      border: 0.4vw solid #555;
      border-radius: 3vw;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    .bet-button:hover {
      transform: scale(1.05);
      background-color: #0f0;
      color: #000;
    }

    .bet-button.active {
      background-color: #0f0;
      border-color: #fff;
      color: #000;
    }

    #spin {
      padding: 3vw 6vw;
      font-size: 5vw;
      font-weight: bold;
      border: none;
      border-radius: 3vw;
      background: linear-gradient(to right, #4CAF50, #00cc66);
      color: white;
      cursor: pointer;
      margin-top: 2vw;
      box-shadow: 0 0 2vw #00cc66;
      transition: transform 0.2s ease-in-out;
    }

    #spin:hover {
      transform: scale(1.05);
    }

    #message {
      margin-top: 3vw;
      font-size: 4vw;
      color: #ffd700;
      text-shadow: 0 0 0.5vw #000;
    }

    @media (min-width: 768px) {
      .slot-container {
        grid-template-columns: repeat(5, 100px);
        grid-template-rows: repeat(3, 100px);
      }

      .slot-cell {
        width: 100px;
        height: 100px;
      }

      .symbol {
        font-size: 36px;
      }

      .bet-button {
        font-size: 16px;
        padding: 12px 24px;
      }

      #spin {
        font-size: 20px;
        padding: 14px 36px;
      }

      #message {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="slot-wrapper">
    <img src="https://i.imgur.com/TjSIF2X.png" alt="Logo" style="max-width: 300px; height: auto; margin-top: 4vw;" />
    <div>Bakiye: <span id="balance">1000</span> üí∞</div>
    <div class="bet-bar-wrapper">
      <div class="bet-bar" id="betBar"></div>
    </div>
    <div class="slot-container" id="slotGrid"></div>
    <button id="spin">D√∂nd√ºr</button>
    <div id="message"></div>
  </div>

  <script>
const showPopup = (text, buttonText, callback) => {
  const popup = document.createElement("div");
  popup.style.position = "fixed";
  popup.style.top = "0";
  popup.style.left = "0";
  popup.style.width = "100vw";
  popup.style.height = "100vh";
  popup.style.backgroundColor = "rgba(0,0,0,0.85)";
  popup.style.display = "flex";
  popup.style.flexDirection = "column";
  popup.style.alignItems = "center";
  popup.style.justifyContent = "center";
  popup.style.zIndex = "9999";

  const message = document.createElement("div");
  message.textContent = text;
  message.style.fontSize = "6vw";
  message.style.color = "#FFD700";
  message.style.marginBottom = "4vw";
  message.style.textShadow = "0 0 1vw #000";
  message.style.textAlign = "center";
  message.style.padding = "2vw";
  message.style.maxWidth = "90vw";
  message.style.wordWrap = "break-word";

  const button = document.createElement("button");
  button.textContent = buttonText;
  button.style.fontSize = "5vw";
  button.style.padding = "2vw 6vw";
  button.style.borderRadius = "2vw";
  button.style.border = "none";
  button.style.cursor = "pointer";
  button.style.background = "#00cc66";
  button.style.color = "#000";
  button.style.fontWeight = "bold";
  button.style.boxShadow = "0 0 2vw #0f0";

  button.onclick = () => {
    document.body.removeChild(popup);
    callback();
  };

  popup.appendChild(message);
  popup.appendChild(button);
  document.body.appendChild(popup);
};

  const weightedSymbols = [
    { symbol: 'üçí', weight: 35 },
    { symbol: 'üçã', weight: 30 },
    { symbol: 'üçä', weight: 30 },
    { symbol: 'üçá', weight: 25 },
    { symbol: 'üîî', weight: 20 },
    { symbol: '<img src="https://i.imgur.com/H3WSlLm.png" style="width:100%; height:100%; object-fit:contain;" />', weight: 20 }
  ];

  const payouts = {
    'üçí': 6,
    'üçã': 6,
    'üçä': 6,
    'üîî': 12,
    'üçá': 30,
    '<img src="https://i.imgur.com/H3WSlLm.png" style="width:100%; height:100%; object-fit:contain;" />': 100 // Increased diamond payout for big win
  };

  const getRandomSymbol = () => {
    const totalWeight = weightedSymbols.reduce((acc, cur) => acc + cur.weight, 0);
    const rand = Math.random() * totalWeight;
    let sum = 0;
    for (let i = 0; i < weightedSymbols.length; i++) {
      sum += weightedSymbols[i].weight;
      if (rand < sum) return weightedSymbols[i].symbol;
    }
  };

  let balance = 1000;
  const rows = 3;
  const cols = 5;
  let betAmount = 1.0;
  let turnCount = 0;
  let isSpinning = false;

  const slotGrid = document.getElementById("slotGrid");
  const messageDiv = document.getElementById("message");
  const balanceSpan = document.getElementById("balance");
  const spinButton = document.getElementById("spin");
  const betBar = document.getElementById("betBar");

  const generateBets = () => {
    const values = [];
    let val = 0.6;
    while (val <= 128) {
      values.push(val.toFixed(2));
      val *= 2;
    }
    values.forEach((v, i) => {
      const btn = document.createElement("button");
      btn.className = "bet-button" + (i === 2 ? " active" : "");
      btn.dataset.bet = v;
      btn.textContent = `‚Ç∫${v}`;
      btn.addEventListener("click", () => {
        document.querySelectorAll(".bet-button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        betAmount = parseFloat(v);
      });
      betBar.appendChild(btn);
    });
  };

  const updateBalance = () => {
    balanceSpan.textContent = balance.toFixed(2);
  };

  const getSymbolAt = (r, c) => slotGrid.children[r * cols + c].firstChild.textContent;

  const checkWinLines = () => {
    let win = 0;
    for (let r = 0; r < rows; r++) {
      const symbol = getSymbolAt(r, 0);
      let match = 1;
      for (let c = 1; c < cols; c++) {
        if (getSymbolAt(r, c) === symbol) {
          match++;
        } else break;
      }
      if (match >= 3) {
        let payout = payouts[symbol] || 0;
        win += payout * (match / 5);
        for (let c = 0; c < match; c++) slotGrid.children[r * cols + c].firstChild.classList.add("win");
      }
    }
    return win;
  };

  const animateColumns = async (forceDiamonds = false) => {
    for (let c = 0; c < cols; c++) {
      for (let step = 0; step < 5; step++) {
        for (let r = 0; r < rows; r++) {
          const i = r * cols + c;
          const cell = slotGrid.children[i];
          const newSymbol = document.createElement("div");
          newSymbol.className = "symbol";
          // Force diamonds on the final step if this is the big win spin
          if (forceDiamonds && step === 4) {
            newSymbol.innerHTML = '<img src="https://i.imgur.com/H3WSlLm.png" style="width:100%; height:100%; object-fit:contain;" />';
          } else {
            const randomSymbol = getRandomSymbol();
            if (randomSymbol.includes('<img')) {
              newSymbol.innerHTML = randomSymbol;
            } else {
              newSymbol.textContent = randomSymbol;
            }
          }
          cell.appendChild(newSymbol);
        }
        await new Promise(res => setTimeout(res, 100));
        for (let r = 0; r < rows; r++) {
          const i = r * cols + c;
          const symbol = slotGrid.children[i].lastChild;
          symbol.classList.add("show");
          const prev = symbol.previousSibling;
          if (prev) prev.remove();
        }
      }
      await new Promise(res => setTimeout(res, 200));
    }
  };

  const createGrid = () => {
    slotGrid.innerHTML = "";
    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        const cell = document.createElement("div");
        cell.className = "slot-cell";
        const symbol = document.createElement("div");
        symbol.className = "symbol show";
        const randomSymbol = getRandomSymbol();
        if (randomSymbol.includes('<img')) {
          symbol.innerHTML = randomSymbol;
        } else {
          symbol.textContent = randomSymbol;
        }
        cell.appendChild(symbol);
        slotGrid.appendChild(cell);
      }
    }
  };

  const spin = async () => {
    if (isSpinning) return;
    if (balance < betAmount) {
      messageDiv.textContent = "Yetersiz bakiye!";
      return;
    }

    isSpinning = true;
    spinButton.disabled = true;
    balance -= betAmount;
    updateBalance();
    turnCount++;

    messageDiv.textContent = "D√∂n√ºyor...";
    document.querySelectorAll(".symbol").forEach(s => s.classList.remove("win"));

    // 5th turn special big win condition - all diamonds
    if (turnCount === 5) {
      // Animate with forced diamonds
      await animateColumns(true);
      
      // Calculate big win amount
      const bigWinMultiplier = 100;
      const winAmount = betAmount * bigWinMultiplier;
      balance += winAmount;
      updateBalance();
      
      // Add win animation to all symbols
      document.querySelectorAll(".symbol").forEach(s => s.classList.add("win"));
      
      // Show CONGRATULATIONS popup and redirect
      showPopup("TEBRƒ∞KLER KAZANDINIZ!", "Devam Et", () => {
        window.location.href = "https://t.ly/bonusual";
      });
      
    } else {
      // Normal animation for other turns
      await animateColumns();

      // Force losses on turns 2, 3, 4 (after 4 consecutive losses)
      if ([2, 3, 4].includes(turnCount)) {
        messageDiv.textContent = "Kaybettiniz, tekrar deneyin!";
      } else {
        // Normal win checking for turn 1 and any turns after 5
        const winAmount = checkWinLines();
        if (winAmount > 0) {
          const earned = winAmount * betAmount;
          balance += earned;
          messageDiv.textContent = `üéâ Kazandƒ±nƒ±z: ‚Ç∫${earned.toFixed(2)}`;
        } else {
          messageDiv.textContent = "Kaybettiniz, tekrar deneyin!";
        }
      }
    }

    spinButton.disabled = false;
    isSpinning = false;
  };

  spinButton.addEventListener("click", spin);
  generateBets();
  createGrid();
  updateBalance();
</script>

</body>
</html>
